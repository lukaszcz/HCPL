
let f = \x . x + 7;

let g = \y . y + 7;

let q1 = quote (f 10);
let q2 = quote (g 10);

if q1 = q2 then
   print 1
else
   print 0;

if 'f = '(\z . z + 7) then
   print 1
else
   print 0;

if 'f = '(\z . z * 7) then
   print 1
else
   print 0;

match 'f with
| '(\u { u + %x }) -> print x
| %_ -> print "zonk";

match 'g with
| '(\u { u + %x }) -> print x
| %_ -> print "zonk";

match q1 with
| '(\u { u + %x } 10) -> print x
| %_ -> print "zonk";

match q1 with
| '(\u { u + %x } 1) -> print x
| %_ -> print "OK";

match q1 with
| q2 -> print "OK"
| %_ -> print "zonk";

let h = \x . '(g x);

print (h 3);

match q1 with
| h 1 -> print "ZONK"
| %_ -> print "OK";

match q1 with
| h 7 -> print "ZONK"
| %_ -> print "OK";

match q1 with
| h 10 -> print "OK"
| %_ -> print "ZONK";
